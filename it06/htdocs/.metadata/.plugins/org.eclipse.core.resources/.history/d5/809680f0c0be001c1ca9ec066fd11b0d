<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">

<title>掲示板</title>

	<link rel="stylesheet" href="css/common.css">



</head>
<body>

<h1>簡易掲示板</h1>
<br>
<br>
<br>




<h2>新規投稿</h2>

	<form action="index.php" method="post">
		<p>名前</p>
		<input type="text" name="a">
		<p>コメント</p>
		<textarea name="b"></textarea>
				<br>
		<br>
		<br>
		<input type="submit" value="送信">



	</form>



<h2>投稿一覧</h2>
<div class = "box">
<?php
$errors=[];
if ($_POST) {
    $a = htmlspecialchars($_POST["a"], ENT_QUOTES);
    $b = htmlspecialchars($_POST["b"], ENT_QUOTES);

    if(null===$a){
        $errors[] .= "名前を入力してください";
    }
    if(null===$b){
        $errors[] .="コメントを入力してください";
    }

    $db = new PDO("mysql:host=127.0.0.1;dbname=BBS;charset=utf8", "root", "");




    $db->query("INSERT INTO tb1(no,name,message,time)
VALUES(NULL,'$a','$b',NOW())");

}


?>

<?php

$db = new PDO("mysql:host=127.0.0.1;dbname=BBS;charset=utf8", "root", "");



$n = $db->query("SELECT * FROM tb1 ORDER BY no DESC limit 20");
while ($i = $n -> fetch()) {
    print "{$i['no']}:{$i['name']}{$i['time']}<br>" . nl2br($i['message']) . "<hr>";
}

?>

</div>

</body>


</html>